<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Menu - Kopi Nusantara</title>
    <link rel="stylesheet" href="../css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="container">
            <div class="logo">
                <i class="fas fa-mug-hot"></i> Kopi Nusantara
            </div>
            <ul class="nav-links">
                <li><a href="../index/index.html">Home</a></li>
                <li><a href="menu.html" class="active">Menu</a></li>
            </ul>
            <div class="auth-buttons">
                <a href="../user/login/login.html" class="login-btn">Login</a>
                <a href="../user/signin/register.html" class="signup-btn">Sign Up</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Header -->
        <div class="menu-header">
            <h1>Our Menu</h1>
            <p>Discover our carefully curated selection of coffee, tea, pastries, and more.</p>
        </div>

        <!-- Search Bar -->
        <div class="search-container">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Search menu...">
            </div>
        </div>

        <!-- Category Filters -->
        <div class="category-filters">
            <button class="category-btn active" data-category="all">All</button>
            <button class="category-btn" data-category="coffee">
                <i class="fas fa-coffee"></i> Coffee
            </button>
            <button class="category-btn" data-category="tea">
                <i class="fas fa-mug-hot"></i> Tea
            </button>
            <button class="category-btn" data-category="pastry">
                <i class="fas fa-cookie-bite"></i> Pastry
            </button>
            <button class="category-btn" data-category="dessert">
                <i class="fas fa-ice-cream"></i> Dessert
            </button>
            <button class="category-btn" data-category="food">
                <i class="fas fa-utensils"></i> Food
            </button>
        </div>

        <!-- Items Counter -->
        <div class="items-counter">
            Showing <span id="itemCount">0</span> items
        </div>

        <!-- Menu Grid -->
        <div class="menu-grid" id="menuGrid"></div>

        <!-- No Results Message -->
        <div class="no-results" id="noResults" style="display: none;">
            <i class="fas fa-search"></i>
            <h3>No items found</h3>
            <p>Try searching with different keywords or browse all categories</p>
        </div>
    </div>
    <div id="footer"></div>
    
    <script>
        // Menu Data
        let menuItems = [];

        // State
        let currentCategory = 'all';
        let searchQuery = '';

        // Format currency
        function formatPrice(price) {
            return `Rp ${price.toLocaleString('id-ID')}`;
        }

        // Render menu items
        function renderMenu() {
            const menuGrid = document.getElementById('menuGrid');
            const noResults = document.getElementById('noResults');
            
            // Filter items
            let filteredItems = menuItems;
            
            if (currentCategory !== 'all') {
                filteredItems = filteredItems.filter(item => item.category === currentCategory);
            }
            
            if (searchQuery) {
                filteredItems = filteredItems.filter(item => 
                    item.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                    item.description.toLowerCase().includes(searchQuery.toLowerCase())
                );
            }
            
            // Update counter
            document.getElementById('itemCount').textContent = filteredItems.length;
            
            // Show/hide no results
            if (filteredItems.length === 0) {
                menuGrid.style.display = 'none';
                noResults.style.display = 'block';
                return;
            } else {
                menuGrid.style.display = 'grid';
                noResults.style.display = 'none';
            }
            
            // Render items
            menuGrid.innerHTML = filteredItems.map(item => `
                <div class="menu-item" onclick="goToDetail(${item.id})">
                    ${item.popular ? '<div class="popular-badge"><i class="fas fa-star"></i> Popular</div>' : ''}
                    <div class="item-image">
                        ${item.image ? `<img src="${item.image}" alt="${item.name}">` : '<i class="fas fa-mug-hot"></i>'}
                    </div>
                    <div class="item-info">
                        <div class="item-category"><i class="fas fa-tag"></i> ${item.category}</div>
                        <div class="item-name">${item.name}</div>
                        <div class="item-description">${item.description}</div>
                        <div class="item-price">${formatPrice(item.price)}</div>
                    </div>
                </div>
            `).join('');
        }

        // Category filter
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentCategory = btn.dataset.category;
                renderMenu();
            });
        });

        // Search
        document.getElementById('searchInput').addEventListener('input', (e) => {
            searchQuery = e.target.value;
            renderMenu();
        });

        // Go to detail page - PERBAIKAN INI YANG PENTING
        function goToDetail(itemId) {
            // Redirect ke folder detail dengan ID yang benar
            window.location.href = `../order/detail/menu-detail.html?id=${itemId}`;
        }

        // Load menu from backend
        function loadMenu() {
            fetch("menu.php") 
            .then(res => res.json())
            .then(data => {
                menuItems = data;
                renderMenu();
            })
            .catch(err => {
                console.error("Error loading menu:", err);
                alert("Gagal memuat menu");
            });
        }

        // Initial load
        loadMenu();

        // Load footer
        fetch('../index/footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            })
            .catch(error => {
                console.error('Error loading footer:', error);
            });
    </script>
</body>
</html>